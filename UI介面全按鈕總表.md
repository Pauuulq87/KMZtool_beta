# UI 介面全按鈕總表

本文件記載系統中所有 UI 介面的按鈕、位置、功能邏輯與操作後的可視變化，以及目前的測試驗證結果。

## 1. 側邊工具列 (Sidebar)

| 介面區域 | 按鈕名稱 | 圖示/標識 | 功能與邏輯 | 使用者可見回饋 (點擊後畫面變化) | 測試結果 |
| :--- | :--- | :--- | :--- | :--- | :--- |
| **側邊欄** | **儲存任務** | **圖示**：<i class="icon-save"></i> (Save)<br>**文字**：儲存 | **功能**：儲存當前編輯的任務狀態。<br>**邏輯**：觸發 `onClick={onSave}`，呼叫 `App.tsx` 的 `handleSaveMission`，整合 `missionService.saveMission` API。 | 顯示「儲存成功」提示或開啟儲存對話框。 | ✅ **已驗證**：可成功儲存任務 (含區域與 POI) 至後端資料庫。 |
| **側邊欄** | **載入任務** | **圖示**：<i class="icon-folder-open"></i> (FolderOpen)<br>**文字**：載入 | **功能**：載入先前儲存的任務。<br>**邏輯**：觸發 `onClick={onLoad}`，呼叫 `App.tsx` 的 `handleLoadMission`，整合 `missionService.getMissions` API。 | 開啟任務列表模態框，選擇後地圖載入任務區域與 POI。 | ✅ **已驗證**：可成功載入任務，地圖正確還原區域與 POI。 |
| **側邊欄** | **匯入** | **圖示**：<i class="icon-upload"></i> (Upload)<br>**文字**：匯入 | **功能**：匯入外部 KML/KMZ 檔案。<br>**邏輯**：點擊觸發隱藏的 `input[type="file"]`，選擇檔案後觸發 `onImport`。 | 開啟系統檔案選擇視窗。匯入成功後，地圖上應顯示匯入的路徑或區域。 | ✅ **已驗證**：可正確匯入 KML/KMZ 並顯示於地圖。 |
| **側邊欄** | **多邊形工具** | **圖示**：<i class="icon-pentagon"></i> (Pentagon)<br>**文字**：多邊形 | **功能**：切換至多邊形繪製模式。<br>**邏輯**：設定 `activeTool` 為 `'polygon'`，啟用 Google Maps DrawingManager 的 Polygon 模式。 | 按鈕變為**高亮 (藍底白字)**。游標在進入地圖區域後變為十字準星，點擊地圖可開始繪製多邊形頂點。 | ✅ **已驗證**：繪製功能正常。 |
| **側邊欄** | **矩形工具** | **圖示**：<i class="icon-square"></i> (Square)<br>**文字**：矩形 | **功能**：切換至矩形繪製模式。<br>**邏輯**：設定 `activeTool` 為 `'rectangle'`，啟用 Google Maps DrawingManager 的 Rectangle 模式。 | 按鈕變為**高亮 (藍底白字)**。游標在進入地圖區域後變為十字準星，拖曳可繪製矩形。 | ✅ **已驗證**：繪製功能正常。 |
| **側邊欄** | **興趣點工具** | **圖示**：<i class="icon-map-pin"></i> (MapPin)<br>**文字**：興趣點 | **功能**：切換至興趣點 (POI) 標記模式。<br>**邏輯**：設定 `activeTool` 為 `'poi'`，啟用 Google Maps DrawingManager 的 Marker 模式。 | 按鈕變為**高亮 (藍底白字)**。點擊地圖可放置標記，並自動依序編號。 | ✅ **已驗證**：放置與編號功能正常。 |
| **側邊欄** | **POI (圓形)** | **圖示**：<i class="icon-circle"></i> (Circle)<br>**文字**：POI (圓形) | **功能**：切換至圓形區域繪製模式。<br>**邏輯**：設定 `activeTool` 為 `'circle'`，啟用 Google Maps DrawingManager 的 Circle 模式。 | 按鈕變為**高亮 (藍底白字)**。拖曳可繪製圓形區域。 | ✅ **已驗證**：繪製功能正常。 |

## 2. 屬性面板 (PropertiesPanel)

### 分頁切換
| 介面區域 | 按鈕名稱 | 圖示/標識 | 功能與邏輯 | 使用者可見回饋 (點擊後畫面變化) | 測試結果 |
| :--- | :--- | :--- | :--- | :--- | :--- |
| **屬性面板** | **參數模式** | **文字**：參數 | **功能**：切換至參數設定分頁。<br>**邏輯**：設定 `activeTab` 為 `'params'`。 | 顯示品質、旋轉、飛行參數與進階開關，並提供「產生路徑」。 | ✅ **已驗證**：切換正常。 |
| **屬性面板** | **下載模式** | **文字**：下載 | **功能**：切換至下載與匯出分頁。<br>**邏輯**：設定 `activeTab` 為 `'download'`。 | 顯示下載選項、KMZ 下載按鈕與儲存任務至帳號的表單。 | ✅ **已驗證**：切換正常。 |

### 參數分頁 (Params Tab)
| 介面區域 | 按鈕名稱 | 圖示/標識 | 功能與邏輯 | 使用者可見回饋 (點擊後畫面變化) | 測試結果 |
| :--- | :--- | :--- | :--- | :--- | :--- |
| **參數分頁** | **重疊率滑桿** | **元件**：Range Slider | **功能**：調整影像重疊率 (10% - 90%)。<br>**邏輯**：更新 `settings.overlap`，連動影響路徑間距計算。 | 滑桿位置改變，右側數值 (例如 70%) 即時更新。 | ✅ **已驗證**：數值更新正常。 |
| **參數分頁** | **旋轉路徑滑桿** | **元件**：Range Slider | **功能**：調整掃描方向角度 0°~360°。<br>**邏輯**：更新 `settings.rotationAngle`，產生路徑時以旋轉後座標生成並再旋回原圖形內。 | 數值隨拖曳改變，重新產生路徑時方向更新。 | ✅ **已驗證**：路徑會依角度旋轉並裁切於框線內。 |
| **參數分頁** | **產生路徑** | **文字**：產生路徑 | **功能**：根據當前設定生成飛行路徑。<br>**邏輯**：觸發 `onClick={onGenerate}`，呼叫 `App.tsx` 的 `handleGenerateMission`，使用 `flightPathUtils` 計算路徑。 | 1. 地圖上出現**藍色飛行路徑**線條。<br>2. 路徑線上顯示**方向箭頭**。<br>3. 顯示帶有**數字編號**的圓形航點。 | ✅ **已驗證**：可正確生成並裁切於多邊形內。 |

### 進階分頁 (Advanced Tab)
| 介面區域 | 按鈕名稱 | 圖示/標識 | 功能與邏輯 | 使用者可見回饋 (點擊後畫面變化) | 測試結果 |
| :--- | :--- | :--- | :--- | :--- | :--- |
| **參數分頁** | **維持高度開關** | **元件**：Toggle Switch | **功能**：切換是否維持固定高度。<br>**邏輯**：切換 `settings.maintainAltitude` 布林值。 | 開關顏色在灰色 (關) 與藍色 (開) 之間切換，圓鈕位置左右移動。 | ✅ **已驗證**：狀態切換正常。 |
| **參數分頁** | **直線飛行開關** | **元件**：Toggle Switch | **功能**：切換是否強制直線飛行 (Straighten Paths)。<br>**邏輯**：切換 `settings.straightenPaths` 布林值。 | 開關顏色與位置切換。 | ✅ **已驗證**：狀態切換正常。 |
| **參數分頁** | **產生所有點開關** | **元件**：Toggle Switch | **功能**：切換是否產生所有路徑點。<br>**邏輯**：切換 `settings.generateEveryPoint` 布林值。 | 開關顏色與位置切換。 | ✅ **已驗證**：狀態切換正常。 |
| **參數分頁** | **反向路徑開關** | **元件**：Toggle Switch | **功能**：反轉路徑的起始與結束點。<br>**邏輯**：切換 `settings.reversePoints` 布林值。 | 開關顏色與位置切換。(需重新點擊「產生路徑」才可見路徑變化) | ✅ **已驗證**：狀態切換正常。 |
| **參數分頁** | **儲存預設值** | **文字**：儲存 | **功能**：將當前參數儲存為預設值。<br>**邏輯**：將 `presetName` 與當前 `settings` 存入 LocalStorage（若同名則覆蓋），並提示成功。 | Alert 顯示「已儲存預設」。 | ✅ **已驗證**：可寫入/覆蓋 LocalStorage。 |

### 下載分頁 (Download Tab)
| 介面區域 | 按鈕名稱 | 圖示/標識 | 功能與邏輯 | 使用者可見回饋 (點擊後畫面變化) | 測試結果 |
| :--- | :--- | :--- | :--- | :--- | :--- |
| **下載分頁** | **分割任務開關** | **元件**：Toggle Switch | **功能**：切換是否分割過大的任務。<br>**邏輯**：切換 `settings.splitMission` 布林值；下載時若航點數 > 200 會自動切割並下載多個 KML。 | 開關顏色與位置切換；下載時出現多個檔案並提示分割數量。 | ✅ **已驗證**：可分割並下載多檔。 |
| **下載分頁** | **下載 KMZ** | **文字**：下載 KMZ | **功能**：下載生成的任務為 .kml/.kmz 檔案。<br>**邏輯**：觸發 `onClick={onDownload}`，呼叫 `App.tsx` 的 `handleDownloadKMZ`，生成 KML Blob 並觸發下載。 | 瀏覽器開始下載名為 `mission.kml` 的檔案。 | ✅ **已驗證**：可成功下載 KML 檔案。 |
| **下載分頁** | **下載自動安裝程式** | **文字**：下載 KMZ 自動安裝程式 V2 | **功能**：暫提供安裝指引檔，正式安裝程式待更新。<br>**邏輯**：生成指引文字檔並觸發下載。 | 立即下載 `KMZ-installer-guide.txt` 並提示。 | ✅ **已驗證**：可成功下載指引檔。 |
| **下載分頁** | **儲存至帳號** | **文字**：儲存 | **功能**：將任務儲存至使用者帳號。<br>**邏輯**：呼叫後端 API 儲存任務資料。 | 顯示儲存成功提示。 | ✅ **已驗證**：整合後端 API 儲存功能。 |

## 3. 地圖區域 (MapContainer)

| 介面區域 | 按鈕名稱 | 圖示/標識 | 功能與邏輯 | 使用者可見回饋 (點擊後畫面變化) | 測試結果 |
| :--- | :--- | :--- | :--- | :--- | :--- |
| **頂部工具列** | **搜尋** | **圖示**：<i class="icon-search"></i> (Search)<br>**輸入框** | **功能**：搜尋地圖地點。<br>**邏輯**：使用 Google Places API `SearchBox`，選取地點後觸發 `places_changed` 事件。 | 地圖視野 (Viewport) 自動平移並縮放至搜尋的地點。 | ✅ **已驗證**：搜尋與定位功能正常。 |
| **頂部工具列** | **Undo** | **圖示**：<i class="icon-undo"></i> (Undo)<br>**文字**：Undo | **功能**：復原上一步操作。<br>**邏輯**：從 `historyStack` 取出上一步狀態並還原地圖物件。 | 地圖上最近新增或修改的物件 (多邊形/POI) 消失或回復原狀。 | ✅ **已驗證**：可復原繪圖操作。 |
| **頂部工具列** | **Redo** | **圖示**：<i class="icon-redo"></i> (Redo)<br>**文字**：Redo | **功能**：重做上一步操作。<br>**邏輯**：從 `redoStack` 取出狀態並重新套用地圖物件。 | 剛被復原的物件重新出現或回復修改後狀態。 | ✅ **已驗證**：可重做繪圖操作。 |
| **頂部工具列** | **Reset** | **圖示**：<i class="icon-rotate-ccw"></i> (RotateCcw)<br>**文字**：Reset | **功能**：重置地圖狀態。<br>**邏輯**：清空所有地圖物件與歷史紀錄。 | 地圖上所有繪製內容被清空。 | ✅ **已驗證**：重置功能正常。 |
| **POI 彈窗** | **儲存 (POI)** | **文字**：儲存 | **功能**：儲存對興趣點的編輯 (座標、高度、動作等)。<br>**邏輯**：觸發 `POIInfoWindow` 的 `onSave`，更新 `MapManager` 中的 POI 資料並關閉彈窗。 | 彈窗關閉，地圖上的 POI 位置若有修改會更新。 | ✅ **已驗證**：POI 屬性編輯可儲存。 |
| **POI 彈窗** | **刪除 (POI)** | **文字**：刪除 | **功能**：刪除該興趣點。<br>**邏輯**：觸發 `POIInfoWindow` 的 `onDelete`，從地圖與資料中移除該 POI。 | 彈窗關閉，該 POI 標記從地圖上消失，路徑線重新連接。 | ✅ **已驗證**：POI 刪除功能正常。 |

## 4. 認證模態框 (AuthModal)

| 介面區域 | 按鈕名稱 | 圖示/標識 | 功能與邏輯 | 使用者可見回饋 (點擊後畫面變化) | 測試結果 |
| :--- | :--- | :--- | :--- | :--- | :--- |
| **認證框** | **關閉** | **圖示**：<i class="icon-x"></i> (X) | **功能**：關閉登入/註冊視窗。<br>**邏輯**：觸發 `onClose`。 | 模態框消失，返回主畫面。 | ✅ **已驗證**：關閉功能正常。 |
| **認證框** | **提交** | **文字**：登入 / 註冊 | **功能**：送出表單進行驗證。<br>**邏輯**：觸發 `handleSubmit`，呼叫 `authService` 進行 API 請求。 | 按鈕顯示「處理中...」。成功後模態框關閉並顯示登入狀態；失敗則顯示錯誤訊息。 | ✅ **已驗證**：登入與註冊 API 串接正常。 |
| **認證框** | **切換模式** | **文字**：立即註冊 / 登入 | **功能**：切換登入或註冊模式。<br>**邏輯**：切換 `isLogin` 狀態。 | 標題與按鈕文字在「登入」與「註冊」間切換，註冊模式會多出「名稱」欄位。 | ✅ **已驗證**：模式切換正常。 |
